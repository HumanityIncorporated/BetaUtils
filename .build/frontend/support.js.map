{
  "version": 3,
  "sources": ["../../frontend/support.js"],
  "sourcesContent": ["\nfunction onLoad() {\n  // send(JSON.stringify({action:\"refresh\"}), (res)=>{\n  // });\n  // send(JSON.stringify({action:\"refresh_users\"}), (res)=>{\n  // });\n  // BTTOMNPUT = document.createElement(\"input\");\n  // REPLYINPUT.className = \"inp\";\n  BOTTOMINPUT = byId(\"bottomInput\");\n  // REPLYINPUT.id = \"rep\"\n  setInterval(updateTime, 5000);\n  document.getElementById(\"header\").innerText = \"Support: \"+(ISBRIDGE?\"&\":\"#\")+\n    docURL.pathname.match(\"^\\\\/(room|bridge)\\\\/(.+)\")[2];\n  let match = docURL.pathname.match(\"^\\\\/(room|bridge)\\\\/(.+)\");\n  ROOMNAME = match[2]\n  document.title = \"Support | \"+(match[1] == \"room\"?\"#\":\"&\")+ROOMNAME;\n  document.addEventListener(\"keydown\", onKeyPress);\n}\nfunction onKeyPress(e) {\n  if (e.key == \"b\" && e.ctrlKey && !e.metaKey && !e.shiftKey) {\n    let ele = byId(\"right\");\n    console.log(e);\n    ele.style.display = (ele.style.display==\"flex\")?\"none\":\"flex\";\n    e.preventDefault();\n  }\n  if (e.target.id == \"msgInp\" && \n      e.key == \"Enter\" && !e.shiftKey) {\n    e.preventDefault();\n    e.stopPropagation();\n    byId(\"inpContainer\").submit();\n    return;\n  }\n  if (e.ctrlKey || e.metaKey || e.shiftKey) return;\n  if (e.key == 'Escape' || e.key == \"ArrowRight\" && byId(\"msgInp\").value==\"\") {\n    byMsgId(ACTIVEREPLY).classList.remove(\"activeReply\");\n    ACTIVEREPLY = -1;\n    toggleActiveReply(-1, true);\n  }\n  if (e.key == \"ArrowLeft\" && byId(\"msgInp\").value==\"\") {\n    if (ACTIVEREPLY == -1) return;\n    toggleActiveReply(ACTIVEREPLY);\n  }\n  if (e.key == \"ArrowDown\" && byId(\"msgInp\").value==\"\") \n  {\n    if (ACTIVEREPLY == -1) return;\n    let leaving = byMsgId(ACTIVEREPLY);\n    if (!leaving.nextElementSibling) // falling off the edge to the parent\n      toggleActiveReply(leaving.dataset.id);\n    else if (leaving.nextElementSibling.children.length == 2) { // the bar and the message content\n      // happy days.\n      let desiredReplyID = leaving.nextElementSibling.dataset.id\n      toggleActiveReply(desiredReplyID, true);\n    }\n    else if (leaving.nextElementSibling.id == \"placeholder\") // probably at the end\n      toggleActiveReply(-1, true)\n    else if (leaving.nextElementSibling.children.length > 2) { // next has children\n      // go to deepest and closest child\n      leaving = leaving.nextElementSibling;\n      while (leaving.children.length > 2) {\n        leaving = leaving.children[2]; // #1 is content, #2 is bar, #3 is child messages\n      }\n      toggleActiveReply(leaving.dataset.id, true)\n    }\n  } // going down!\n  if (e.key == \"ArrowUp\" && byId(\"msgInp\").value==\"\") {\n    let leaving = byMsgId(ACTIVEREPLY);\n    if (ACTIVEREPLY == -1) {\n      leaving = byId(\"placeholder\").previousElementSibling;\n      // while (leaving.children.length > 2) {\n        // leaving = leaving.children[leaving.children.length-1]; // #1 is content, #2 is bar, #3 is child messages\n      // }\n      toggleActiveReply(leaving.dataset.id, true);\n    }\n    // else if (!leaving.previousElementSibling) return;\n    else if (leaving.children.length > 3) { // can go to child\n      // falling off the edge to the parent\n      leaving = leaving.children[leaving.children.length-2];\n      // while (leaving.children.length > 3) {\n        // leaving = leaving.children[2]; // #1 is content, #2 is bar, #3 is child messages, last is text box\n      // }\n      // toggleActiveReply(leaving.dataset.id, true)\n      toggleActiveReply(leaving.dataset.id, true);\n    }\n    else if (leaving.previousElementSibling && leaving.previousElementSibling.className != \"bar\") \n    {\n      // console.log(\"prevelement\");\n      toggleActiveReply(leaving.previousElementSibling.dataset.id, true);\n    }\n    else {\n      // if there are no children and there are no siblings:\n      leaving = byMsgId(ACTIVEREPLY).parentElement;\n      while (leaving.previousElementSibling && \n             (leaving.previousElementSibling.className == \"bar\")) {\n        leaving = leaving.parentElement;\n      }\n      if (leaving.previousElementSibling)\n        toggleActiveReply(leaving.previousElementSibling.dataset.id, true);\n    }\n    // else if (leaving.nextElementSibling.children.length == 2) { // the bar and the message content\n    //   // happy days.\n    //   let desiredReplyID = leaving.nextElementSibling.dataset.id\n    //   toggleActiveReply(desiredReplyID, true);\n    // }\n    // else if (leaving.nextElementSibling.id == \"placeholder\") // probably at the end\n    //   toggleActiveReply(-1, true)\n    // else if (leaving.nextElementSibling.children.length > 2) { // next has children\n    //   // go to deepest and closest child\n    //   leaving = leaving.nextElementSibling;\n    //   while (leaving.children.length > 2) {\n    //     leaving = leaving.children[2]; // #1 is content, #2 is bar, #3 is child messages\n    //   }\n    //   toggleActiveReply(leaving.dataset.id, true)\n    // }\n  }\n}\nfunction updateTime() {\n  let allElements = document.getElementsByClassName(\"time\");\n  for (let ele of allElements) {\n    ele.innerText = minimalTime(Date.now()-ele.dataset.time*1000);\n  }\n}\n// system refresh auto!\nlet ACTIVEREPLY = -1;\nlet awaitingParent = [];\nlet BOTTOMINPUT = null\nfunction byMsgId(id) \n{\n  return byId(\"msgArea\").querySelector(\"[data-id='\"+id+\"']\")\n}\nfunction toggleActiveReply(id, forceQ = false) // force to set reply to ID ALWAYS \n{ \n  try {\n    if (forceQ) {\n      byMsgId(ACTIVEREPLY).classList.remove(\"activeReply\");\n      if (id != \"-1\") byMsgId(id).classList.add(\"activeReply\");\n      else byId(\"container\").appendChild(BOTTOMINPUT);\n      ACTIVEREPLY = id;\n      updateReplyBox();\n      return;\n    }\n    if (id == -1) { // you clicked the banner\n      byMsgId(-1).style.display = \"none\";\n      return;\n      // byMsgId(-1).style.transition= \"all 0.5s\";\n      // byMsgId(-1).style.height = \"0px\";\n      // byMsgId(-1).style.opacity = \"0\";\n      // byMsgId(-1).style.touchAction = \"none\";\n    }\n    if (ACTIVEREPLY == id) { // clicking again: activereply parent or clear activereply\n      byMsgId(id).classList.remove(\"activeReply\");\n      let parent = byMsgId(id).parentElement;\n      if (parent.dataset.id) {\n        ACTIVEREPLY = parent.dataset.id;\n        parent.classList.add(\"activeReply\");\n      }\n      else ACTIVEREPLY = -1;\n      byId(\"container\").appendChild(BOTTOMINPUT);\n      // BOTTOMINPUT.style.display=\"flex\";\n    }\n    else { // okay, not clicking again\n      // are you clicking on the direct child?\n      if (byMsgId(id).parentElement.dataset.id == ACTIVEREPLY) {\n        // that's right!\n        // okay so now activereply is the one you clickedre\n        if (ACTIVEREPLY != -1)\n          byMsgId(ACTIVEREPLY).classList.remove(\"activeReply\");\n        ACTIVEREPLY = id;\n        byMsgId(id).classList.add(\"activeReply\");\n  \n      }\n      // are you clicking on something else?\n      // at this point you definitely are\n      // does it even have a parent?\n      else if (!byMsgId(id).parentElement.dataset.id) {\n        if (ACTIVEREPLY != -1)\n          byMsgId(ACTIVEREPLY).classList.remove(\"activeReply\");\n        ACTIVEREPLY = id;\n        byMsgId(id).classList.add(\"activeReply\");\n      }\n      // okay, it does\n      else {\n        let parent = byMsgId(id).parentElement;\n        if (ACTIVEREPLY != -1) \n          byMsgId(ACTIVEREPLY).classList.remove(\"activeReply\");\n        ACTIVEREPLY = parent.dataset.id;\n        parent.classList.add(\"activeReply\");\n        \n      }\n    }\n    updateReplyBox();\n  } catch(e) {\n    console.warn(\"ERROR:\", e)\n  }\n  // BOTTOMINPUT.style.display=(ACTIVEREPLY==\"-1\"?\"flex\":\"none\");\n}\n\nfunction updateReplyBox() \n{\n  if (ACTIVEREPLY == \"-1\") {\n    byId(\"msgInp\").focus();\n    return;\n  }\n  byMsgId(ACTIVEREPLY).appendChild(BOTTOMINPUT);\n  byId(\"msgInp\").focus();\n}\nlet failCt = 0;\nfunction updateAlias() {\n  // source.close();\n  let newAlias = byId(\"alias\").value;\n\n  // if (true) {\n    // console.log(\"here\");\n\n    source.send(JSON.stringify({\n      action:\"updateAlias\", \n      data:{alias:newAlias}\n    }));\n    byId(\"msgInp\").focus();\n  // }\n  // else {\n  //   source.close();\n  //   document.getElementById(\"userList\").innerHTML = ``;\n  //   send(JSON.stringify({action:\"realias\", data:{alias:newAliass}}), (res)=>{\n  //     if (res.status != \"SUCCESS\") alertDialog(\"ERROR: \"+res.data.error, ()=>{});\n  //     else alertDialog(\"Updated alias!\", ()=>{\n  //       STARTID = -1;\n  //       STARTIDVALID = false;\n  //       loadStatus = -1;\n  //       document.getElementById(\"msgArea\").innerHTML = `<h2 id=\"placeholder\">\n  //       <span class=\"material-symbols-outlined\">update</span> \n  //       Reloading your messages, a moment please...</h2>`;\n  //       initClient();\n  //     });\n  //   });\n  // }\n}\n\nfunction sendMsg(ev) {\n  if (ev && ev.target.id != \"msgInp\") return;\n  let inp = document.getElementById(\"msgInp\");\n  if (inp.value.length == 0) return;\n  // byId(\"msgInp\").value = \"\";\n  // let match = inp.value.match(\"^!alias @(.+)\");\n  // if (match) {\n  //   updateAlias(match[1])\n  //   // } // not bridge\n  // }\n  // else {\n    if (ISBRIDGE) source.send(JSON.stringify({action:\"sendMsg\", data:{msg:inp.value, room:ROOMNAME, parent:ACTIVEREPLY}}));\n    else send(JSON.stringify({action:\"sendMsg\", data:{msg:inp.value, room:ROOMNAME, parent:ACTIVEREPLY}}), (res)=>{\n      \n    }, true);\n    // toggleActiveReply()\n  // }\n  inp.value=\"\";\n  fitSize2();\n  // byId(\"alias-text\").value=\"\"\n}\n\nfunction fitSize() {\n  byId(\"alias-text\").innerText = byId(\"alias\").value;\n  byId(\"alias\").focus();\n}\n\nfunction fitSize2(event) {\n  // console.log(event);\n\n  console.log(byId(\"msgInp\").value)\n  byId(\"msg-text\").innerText = byId(\"msgInp\").value+\" \";\n  byId(\"msgInp\").focus();\n  // event.preventDefault();\n}\n  \nconst rmvReg = /(>|^)\\-(.+)\\([0-9]\\)>/gm;\nconst addReg = /(>|^)\\+(.+)\\([0-9]\\)>/gm;\nconst classStr = [\"error\", \"user\", \"admin\", \"superadmin\"]\nlet source = null;\nlet CONNECTIONID = -1;\nasync function initClient()\n{\n  \n  try {\n  console.log(\"Starting client.\")\n  // let isBridge = docURL.searchParams.get(\"bridge\");\n  if (ISBRIDGE)\n    source = new WebSocket('wss://'+docURL.host+'/bridge?room='+\n       docURL.pathname.match(\"^\\/(room|bridge)\\/(.+)\")[2]);\n  else source = new WebSocket('wss://'+docURL.host+'?room='+\n                                 docURL.pathname.match(\"^\\/(room|bridge)\\/(.+)\")[2]);\n  source.onclose = ()=>{\n    ephemeralDialog(\"Connection failed, reconnecting...\");\n    failCt++;\n    if (failCt>5) location.reload();\n    console.log(\"Connection closed by server.\"); setTimeout(initClient, 2000);\n  };\n  // source.onerror = ()=>{\n  //   ephemeralDialog(\"Connection error, reconnecting...\")\n  //   // source.close();\n  //   failCt++;\n  //   if (failCt>5) location.reload();\n  //   console.log(\"Connection ERROR\"); setTimeout(initClient, 2000)\n  // };\n  source.onmessage = (message) => {\n    message = JSON.parse(message.data);\n    \n    if (message.action != \"ping\") console.log('RECV', message);\n    ele = document.getElementById(\"userList\");\n    // let modif = message.data;\n    let action = message.action;\n    if (message.action == \"CONNECTIONID\") {\n      \n      CONNECTIONID = message.data.id;\n    }   \n    let area = document.getElementById(\"msgArea\");\n    let scrDistOKQ =  (area.scrollTop) >= (area.scrollHeight-area.offsetHeight - 100)\n    if (message.action == \"logs\") {\n      // message.data.logs.sort((a, b)=>{\n      //   // console.log(Math.abs(a.id));\n      //   return Math.abs(a.id)-Math.abs(b.id)\n      // });\n      // console.log(message.data.logs);\n      for (let i=0; i<message.data.logs.length; i++) {\n        // console.log(message.data.logs[i].id)\n        handleMessageEvent(message.data.logs[i], area);\n      }\n    }\n    if (message.action == \"forceReload\") location.reload();\n    if (message.action == \"ping\") {\n      console.log(\"pong sent\");\n      source.send(JSON.stringify({action:\"pong\"}));\n    }\n    if (message.action == \"RELOAD\" || message.action == \"RESTART\") {\n      document.getElementById(\"msgArea\").innerHTML = `<h2 id=\"placeholder\">\n        <span class=\"material-symbols-outlined\">update</span> \n        Reloading your messages, a moment please...</h2>`;\n      document.getElementById(\"userList\").innerHTML = \"\";\n      LOADEDQ2=false;\n      STARTID=-1;\n      ACTIVEREPLY = -1;\n      STARTIDVALID = false;\n      byId(\"container\").appendChild(BOTTOMINPUT);\n      UNREAD = 0;\n      document.title = \"Support\"\n      loadStatus = -1;\n      CONNECTIONID = -1;\n      awaitingParent = [];\n      ephemeralDialog(\"Connected!\");\n      if (message.action == \"RESTART\") source.close();\n    }    \n    if (message.action == \"delMsg\") {\n      let ele = byMsgId(message.data.id);\n      if (ele) ele.remove();\n      if (!byMsgId(ACTIVEREPLY)) {\n        ACTIVEREPLY = -1;\n        toggleActiveReply(-1, true);\n      }\n      // if (ele.closest())\n    }\n    if (message.action == \"autoThreading\") {\n      toggleActiveReply(message.data.id);\n    }\n    if (message.action == \"LOADCOMPLETE\") {\n      let thing = document.getElementById(\"msgArea\")\n      if (message.data.id<0) {\n        if (!byId(\"errorEle\")) {\n          let errorEle = document.createElement(\"b\");\n          errorEle.className = \"red\";\n          errorEle.id=\"errorEle\";\n          errorEle.innerText = \"No more messages to load\";\n          errorEle.style.display=\"block\";\n          thing.prepend(errorEle);\n        }\n      }\n      else {\n        loadStatus = -1;\n        STARTID=message.data.id;\n        // alert(\"lcMatchId updated\"+ STARTID);\n      }\n      setTimeout(()=>{\n        if (byId(\"msgArea\").scrollHeight <= byId(\"msgArea\").clientHeight) \n          onScroll();\n      }, 500);\n      console.log(\"Fixing awaitingParent.\")\n      fixAwaitingParent();\n      thing.scrollTop = thing.scrollTop+1;\n    }    \n    if (message.action == \"removeUser\") {\n      let ele2 = byId((message.data.isBot?\"zbot\":\"usr\")+message.data.user);\n      if (ele2) ele2.remove();\n    }\n    if (message.action==\"addUser\") {\n      let span = document.createElement(\"p\");\n      span.innerText = message.data.user;\n      span.id = (message.data.isBot?\"zbot\":\"usr\")+message.data.user;\n      span.title = message.data.user;\n      if (message.data.isBot) span.classList.add(\"bot\");\n      ele.appendChild(span);\n    }\n    if (message.action== \"yourAlias\") {\n      byId(\"alias\").value = message.data.alias;\n      byId(\"alias-text\").innerText = message.data.alias\n      if (message.data.error) ephemeralDialog(\"Error: You are not logged in and cannot update your alias.\")\n      byId(\"msgInp\").focus();\n    }\n    if (message.action == \"addUser\" || message.action == \"removeUser\") {\n      // console.log(\"sorting\");\n      let children = ele.childNodes;\n      let outArr = [];\n      for (let i=0; i<children.length; i++) \n        outArr.push(children[i]);\n      outArr.sort(function(a, b) {\n        return a.id == b.id?0:(a.id > b.id?1:-1);\n      });\n      ele.innerHTML = \"\";\n      for (i=0; i<outArr.length; i++) {\n        ele.appendChild(outArr[i]);\n      }\n    }\n    let modif = \"\";\n    // console.log(modif);\n    // let msgs = modif.split(\">\");\n    if (message.action == \"msg\") {\n      // first fix things for arrow navigation\n      // console.log(message.data.time);\n      handleMessageEvent(message.data, area);\n    } // received message element // \n    // alert(\"here\")\n    if (!LOADEDQ2 || scrDistOKQ)\n    {\n      area.scrollTop = area.scrollHeight;\n      // console.log(\"Scrolling to bottom.\")\n      LOADEDQ2 = true;\n      // alert(\"scrolled\")\n    }\n    // else alert(\"invalid\")\n\n    \n  } // handler function;\n  } catch (e) {\n    alert(e);\n    console.log(\"Restartng client (\"+e+\")\")\n    setTimeout(initClient, 0);\n  }\n  document.getElementById(\"msgInp\").focus();\n} // initClient();\n\n\nconst replacements = [\n  {from: \"one\", to: \"counter_1\"},\n  {from: \"two\", to: \"counter_2\"},\n  {from: \"three\", to: \"counter_3\"},\n  {from: \"four\", to: \"counter_4\"},\n  {from: \"five\", to: \"counter_5\"},\n  {from: \"six\", to: \"counter_6\"},\n  {from: \"seven\", to: \"counter_7\"},\n  {from: \"eight\", to: \"counter_8\"},\n  {from: \"nine\", to: \"counter_9\"},\n  {from: \"zero\", to: \"counter_0\"},\n  {from: \"white_check_mark\", to: \"check_circle\"},\n  {from: \"active\", to: \"check_circle\"},\n  {from: \"info\", to: \"info\"},\n  {from: \"confirm\", to:\"check\"},\n  {from: \"warn\", to: \"warning\"},\n  {from: \"error\", to:\"error\"},\n  {from: \"egg\", to:\"egg_alt\"},\n  {from: \"rotating_light\", to:\"e911_emergency\"},\n  {from: \"sparkles\", to:\"magic_button\"},\n  {from: \"mask\", to:\"medical_mask\"}\n]\n\n// function replaceAll(msg, ele, matches) {\n//   console.log(msg, ele, matches);\n//   for (let j=0; j<replacements.length; j++) {\n//     let regex = new RegExp(replacements[j].from, \"gmiu\");\n//     while ((arr = regex.exec(msg)) !== null) {\n//       console.log(`Found ${arr[0]}. `, arr.index);\n//       let fragment = document.createElement(\"span\");\n//       fragment.className = classStr[matches[3]];\n//       console.log(msg.slice(0, arr.index));\n//       if (msg.slice(0, arr.index)) replaceAll(msg.slice(0, arr.index), ele, matches);\n//       let replaced = document.createElement(\"span\");\n//       replaced.className=\"material-symbols-outlined supportMsg \"+classStr[matches[3]];\n//       replaced.innerText = replacements[j].to;\n//       console.log(replaced);\n//       ele.appendChild(replaced);\n//       msg = msg.slice(arr.index+replacements[j].from.length);\n//       console.log(msg);\n//     }\n//   } // for replacements\n// }\n\nfunction findReplacement(thing) {\n  for (let i=0; i<replacements.length; i++) {\n    if (replacements[i].to == thing) return replacements[i].from;\n  }\n}\n\nwindow.addEventListener(\"blur\", () => {\n  UNREAD = 0;\n  FOCUSSED = false;\n});\n\n// when the user's focus is back to your tab (website) again\nwindow.addEventListener(\"focus\", () => {\n  document.title = \"Support\";\n  FOCUSSED = true;\n  UNREAD = 0;\n});\n\nlet UNREAD = 0;\nlet FOCUSSED = true;\nlet STARTID = -1;\nlet LOADEDQ2 = false;\nlet STARTIDVALID = false;\nlet earliestMessageTime = 9e99;\nlet earliestMessageID = \"\";\nlet ISBRIDGE = docURL.pathname.match(\"^\\\\/bridge\")!= null;\nfunction onScroll() {\n  \n  if (document.getElementById(\"msgArea\").scrollTop < 30 && STARTIDVALID && loadStatus<0) {\n    loadStatus = 0;\n    console.log(\"loading messages from\" + STARTID)\n    if (ISBRIDGE)\n      source.send(JSON.stringify({action:\"loadLogs\", data:{before:earliestMessageID}}));\n    else {\n      \n      send(JSON.stringify({action:\"loadLogs\", data:{room:ROOMNAME, id:CONNECTIONID, from:STARTID}}), ()=>{}, true);\n    }\n  }\n  \n  else if (document.getElementById(\"msgArea\").scrollTop < 30) console.log(\"loadStatus\" + loadStatus)\n}\nlet loadStatus = -1;\n\nfunction fixAwaitingParent() \n{\n  console.log(awaitingParent);\n  for (let i=0; i<awaitingParent.length; i++) {\n    if (byMsgId(awaitingParent[i].parent)) {\n      let ctner = byMsgId(awaitingParent[i].parent);\n      if (!byMsgId(awaitingParent[i].ele.dataset.id)) {// do not add if it has already been added\n        if (awaitingParent[i].prependQ) \n          // referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n          ctner.insertBefore(awaitingParent[i].ele, ctner.children[1]);\n        else ctner.appendChild(awaitingParent[i].ele);\n        // console.log(\"actually added\", awaitingParent[i].ele);\n      }\n      // else console.log(\"didnt'actually add\")\n      // console.log(\"added\");\n      awaitingParent.splice(i, 1);\n      // console.log(awaitingParent);\n      i=-1;\n    }\n  }\n}\n\nfunction handleMessageEvent(data, area) {\n  ele = document.createElement(\"md-span\");\n  matches = [\"ERROR\", data.id, data.sender, data.perms, data.content];\n  // let matches = msgs[i].match(/{(-?[0-9]+)}\\[(.+)\\]\\(([0-9])\\)(.*)/)\n  if (!matches) return;\n\n  PREPENDFLAG = false;\n  if (STARTID<0 || matches[1] == 0) {\n    STARTID = Number(matches[1]);\n    STARTIDVALID = true;\n    // alert(STARTID);\n  }\n  if (matches[1][0] == \"-\") {\n    // console.log(\"PREPENDING\")p\n    PREPENDFLAG = true;\n    matches[1] = matches[1].toString().slice(1);\n    if (loadStatus == 0) loadStatus = 1;\n  }\n  if (data && data.id && \n    byMsgId(matches[1])) return;\n  if (data.time) \n  if (data.time < earliestMessageTime) {\n    earliestMessageTime = data.time;\n    earliestMessageID = matches[1];\n  }\n  // let newMsgBody = document.createTextNode();\n  let newMsgSender = document.createElement(\"b\");\n  // parse things\n  newMsgSender.innerText = matches[2];\n  newMsgSender.className = classStr[matches[3]];\n\n  let ctn = document.createElement(\"div\");\n  ctn.dataset.id=matches[1];\n  ctn.dataset.senderID = data.senderID\n  ctn.className='msgContainer';\n  // if (!PREPENDFLAG) ctn.appendChild(newMsgSender);\n  // newMsgBody.className = classStr[matches[3]];\n  let msg = \"\"+matches[4].replaceAll(\"&gt;\", \";gt;\").replaceAll(\">\", \";gt;\");\n  for (let i=0; i<replacements.length; i++) {\n    msg = msg.replaceAll(`:${replacements[i].from}:`, \">EMOJI\"+replacements[i].to+\">\");\n  }\n  let slashMe = false;\n  msg = msg.replaceAll(/(&[a-zA-Z0-9]{1,20})([^;]|$)/gm,\">ROOM$1>$2\")\n  msg = msg.replaceAll(/(#[a-zA-Z0-9_\\-]{1,20})([^;]|$)/gm,\">SUPPORT$1>$2\")\n  msg = msg.replaceAll(/(;gt;;gt;[a-zA-Z0-9\\-/]{1,90})/g,\">INTERNALLINK$1>\");\n  msg = msg.replaceAll(/((http|ftp|https):\\/\\/)?(?<test>([\\w_-]+(?:(?:\\.[\\w_-]+)+))([\\w.,@?^=%&:\\/~+#-]*[\\w@?^=%&\\/~+#-]))/gmiu,\">LINK$<test>>\")\n  msg = msg.replaceAll(/\\n/gmiu,\">BR>\")\n  // console.log(msg);\n  if (msg.match(\"^[ \\n]*/me(.*)\")) {\n    msg = msg.match(\"^[ \\n]*/me(.*)\")[1];\n    slashMe = true;\n    ele.className += \" slashMe \" + classStr[matches[3]];\n  }\n  else ele.className = classStr[matches[3]];\n\n  let split = msg.split(\">\");\n  // console.log(\"message fragments:\", split.length, split);\n  let out= \"\";\n  for (let i=0; i<split.length; i++) {\n    if (i%2 == 0) {\n      let fragment = document.createTextNode(split[i].replaceAll(\";gt;\", \">\"));\n      fragment.className = classStr[matches[3]] //+ (slashMe?\" slashMe \":\"\");\n      // fragment.innerText = split[i].replaceAll(\";gt;\", \">\");\n      ele.appendChild(fragment);\n    }\n    else {\n      let pref = split[i].match(\"^(EMOJI|LINK|ROOM|SUPPORT|INTERNALLINK|BR)\")[1];\n      let post = pref!=\"BR\"?(split[i].match(\"^(EMOJI|LINK|ROOM|SUPPORT|INTERNALLINK|BR)(.+)\")[2]):\"\";\n      if (pref == \"EMOJI\") {\n        let replaced = document.createElement(\"span\");\n        replaced.title = \":\"+findReplacement(post)+\":\";\n        replaced.className=\"material-symbols-outlined supportMsg \"+classStr[matches[3]] + (slashMe?\" slashMe \":\"\");\n        replaced.innerText = post;\n        ele.appendChild(replaced);\n      }\n      else if (pref == \"LINK\") {\n        let replaced = document.createElement(\"a\");\n        replaced.className=\"supportMsg \"+classStr[matches[3]] //+ (slashMe?\" slashMe \":\"\");\n        replaced.href = \"https://\"+post.replaceAll(\";gt;\", \">\");\n        replaced.innerText = post.replaceAll(\";gt;\", \">\");\n        replaced.setAttribute(\"target\", \"_blank\");\n        ele.appendChild(replaced);\n      }\n      else if (pref == \"ROOM\") {\n        let replaced = document.createElement(\"a\");\n        replaced.className=\"supportMsg \"+classStr[matches[3]] //+ (slashMe?\" slashMe \":\"\");\n        replaced.href = \"/bridge/\"+post.slice(1);\n        replaced.innerText = post;\n        ele.appendChild(replaced);\n      }\n      else if (pref == \"SUPPORT\") {\n        let replaced = document.createElement(\"a\");\n        replaced.className=\"supportMsg \"+classStr[matches[3]] //+ (slashMe?\" slashMe \":\"\");\n        replaced.href = \"/room/\"+post.slice(1);\n        replaced.innerText = post;\n        ele.appendChild(replaced);\n      }\n      else if (pref == \"INTERNALLINK\") {\n        let replaced = document.createElement(\"a\");\n        replaced.className=\"supportMsg \"+classStr[matches[3]] //+ (slashMe?\" slashMe \":\"\");\n        replaced.href = \"/\"+post.slice(8).replaceAll(\";gt;\", \">\");\n        // replaced.setAttribute(\"target\", \"_blank\");\n        replaced.innerText = \">>\"+post.slice(8).replaceAll(\";gt;\", \">\");\n        ele.appendChild(replaced);\n      }\n      else if (pref == \"BR\") {\n        ele.appendChild(document.createElement(\"br\"));\n      }\n    }\n  }\n\n  let ctn_inner = document.createElement(\"div\");\n  ctn_inner.className = \"msgContents\";\n  ctn_inner.appendChild(newMsgSender);\n  ctn_inner.appendChild(ele);\n  ctn_inner.dataset.message = data.content\n  ctn_inner.innerHTML += `<div class=\"time\" data-time=\"${data.time}\">${minimalTime(Date.now()-data.time*1000)}</div>`\n  if (Date.now()/1000 - data.time < 60)\n    ctn_inner.style.animation = \"newMsg \"+(60-(Date.now()/1000-data.time))+\"s\";\n  let optn = document.createElement(\"div\");\n  optn.className = \"options\";\n  optn.onclick = (ev)=>{\n    ev.preventDefault();\n    ev.stopPropagation();\n  };\n  // console.log(data.perms, data.sender);\n  if (data.sender != \"[SYSTEM]\") optn.innerHTML = `\n    <button class=\"btn\" onclick=\"copyMessage(event)\">\n      <span class=\"material-symbols-outlined blu\">content_copy</span>\n      Copy message contents\n    </button>\n    <button class=\"btn\" onclick=\"replyMessage(event)\">\n      <span class=\"material-symbols-outlined blu\">reply</span>\n      Reply\n    </button>`;\n  else optn.remove();\n  // console.log(byId(\"alias\").value);\n  if (userData.user == ctn.dataset.senderID\n   || byId(\"alias\").value == ctn.dataset.senderID\n     || userData.perms && userData.perms >=2 )\n    optn.innerHTML += `\n    <!-- <button class=\"btn\">\n    //   <span class=\"material-symbols-outlined ylw\">edit</span>\n    //   Edit message\n    // </button>-->\n    <button class=\"btn\" onclick=\"deleteMessage(event)\">\n      <span class=\"material-symbols-outlined red nooutline\">delete</span>\n      Delete message\n    </button>`;\n  ctn_inner.appendChild(optn);\n  ctn.appendChild(ctn_inner);\n  let bar = document.createElement(\"div\");\n  bar.className = \"bar\";\n  ctn.appendChild(bar);\n  ctn_inner.onclick=\n    (ev)=>{ \n      toggleActiveReply(ctn.dataset.id);\n    }\n  // area.appendChild(document.createElement(\"br\"));\n  if (data.perms == 3 && data.sender == \"[SYSTEM]\") ctn.dataset.id=\"-1\";\n\n  if (data.parent != undefined && \n      (isNaN(data.parent) || data.parent >= 0)) { // euph: parent is a NaN string\n    if (byMsgId(data.parent)) {\n      // if (PREPENDFLAG) byId(data.parent).prepend(ctn);\n      byMsgId(data.parent).appendChild(ctn);\n      for (let i=0; i<awaitingParent.length; i++) {\n        if (awaitingParent[i].ele.dataset.id == ctn.dataset.id) {\n          awaitingParent.splice(i, 1);\n          break;\n        }\n      } // remove already awaiting parent\n    }\n    else {\n      awaitingParent.push({parent:data.parent, ele:ctn, prependQ:ISBRIDGE&&PREPENDFLAG});\n      console.log(\"awaiting parent\", data.parent, ctn);\n    }\n  }\n  else {\n    if (PREPENDFLAG) area.prepend(ctn);\n    else area.appendChild(ctn);\n  }\n  document.getElementById(\"placeholder\").style.display=\"none\";\n  if (!FOCUSSED) {\n    UNREAD ++ \n    document.title = \"(\"+UNREAD+\") | Support\"\n  }\n  updateReplyBox();\n  if (data.autoThread) \n    toggleActiveReply(data.id);\n  if (byMsgId(-1)) byMsgId(-1).querySelector(\".msgContents\").style.animation = \"\";\n  if (byMsgId(-1)) byId(\"msgArea\").appendChild(byMsgId(-1));\n  byId(\"msgArea\").insertBefore(byId(\"placeholder\"), byMsgId(-1))\n  // byMsgId(-1).style.display = \"none\";\n}\n\nfunction copyMessage(ev) {\n  let el = ev.currentTarget.parentElement.parentElement;\n  navigator.clipboard.writeText(el.dataset.message);\n  ephemeralDialog(\"<span class='material-symbols-outlined grn'>check_circle</span> Copied\")\n}\nfunction replyMessage(ev) {\n  // console.log(ev.currentTarget.parentElement.parentElement)\n  let id = ev.currentTarget.parentElement.parentElement.parentElement.dataset.id;\n  toggleActiveReply(id, true);\n  // console.log(\"hello\", id);\n}\nfunction deleteMessage(ev) {\n  let id = ev.currentTarget.parentElement.parentElement.parentElement.dataset.id;\n  send(JSON.stringify({action:\"delMsg\", data:{id:id, room:ROOMNAME}}), (res)=>{\n    console.log(res);\n  });\n}"],
  "mappings": "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",
  "names": ["ele", "i"]
}
