{
  "version": 3,
  "sources": ["../../frontend/support.js"],
  "sourcesContent": ["function onLoad() {\n  // send(JSON.stringify({action:\"refresh\"}), (res)=>{\n  // });\n  // send(JSON.stringify({action:\"refresh_users\"}), (res)=>{\n  // });\n  document.getElementById(\"header\").innerHTML = \"Support: #\"+\n    document.URL.match(\"\\\\?room=(.*)\")[1];\n  ROOMNAME = document.URL.match(\"\\\\?room=(.*)\")[1];\n}\n// system refresh auto!\nfunction sendMsg() {\n  let inp = document.getElementById(\"msgInp\");\n  send(JSON.stringify({action:\"sendMsg\", data:{msg:inp.value, room:ROOMNAME}}), ()=>{});\n  inp.value=\"\";\n}\nlet LOADEDQ2 = false;\nconst rmvReg = /(>|^)\\-(.+)\\([0-9]\\)>/gm;\nconst addReg = /(>|^)\\+(.+)\\([0-9]\\)>/gm;\nconst classStr = [\"error\", \"user\", \"admin\", \"superadmin\"]\nasync function initClient()\n{\n  \n  try {\n  console.log(\"Starting client.\")\n  const source = new EventSource('/stream?room='+\n                                 document.URL.match(\"\\\\?room=([0-9a-zA-Z\\\\-_]{1,20})$\")[1]);\n  source.addEventListener('message', message => {\n    console.log('Got', message);\n    ele = document.getElementById(\"userList\");\n    let modif = message.data;\n    document.getElementById(\"placeholder\").style.display=\"none\";\n\n    let removed = rmvReg.exec(modif);\n    let added = addReg.exec(modif)\n    while (removed || added) {\n      if (removed) {\n        ele.innerText= ele.innerText.replace(removed[2]+\"\\n\", \"\");\n      }\n      if (added) {\n        ele.innerText+= added[2]+\"\\n\";\n      }\n      modif = modif.replaceAll(rmvReg, \"\");\n      modif = modif.replaceAll(addReg, \"\");\n      removed = modif.match(rmvReg);\n      added = modif.match(addReg);\n    }\n    ele = document.getElementById(\"msgArea\");\n    let scrDistOKQ =  (ele.scrollTop) >= (ele.scrollHeight-ele.offsetHeight - 100)\n    let msgs = modif.split(\">\");\n    for (let i=0; i<msgs.length; i++) {\n      let matches = msgs[i].match(/\\[(.+)\\]\\(([0-9])\\)(.*)/)\n      if (!matches) continue;\n      let newMsgBody = document.createElement(\"p\");\n      let newMsgSender = document.createElement(\"b\");\n      // parse things\n      newMsgSender.innerText = matches[1];\n      newMsgSender.className = classStr[matches[2]];\n      ele.appendChild(newMsgSender);\n      newMsgBody.className = classStr[matches[2]];\n      let msg = matches[3].replaceAll(\"&gt;\", \">\");\n      // start replacing emojis\n      for (let j=0; j<replacements.length; j++) {\n        let regex = new RegExp(replacements[j].from, \"gmiu\");\n        while ((arr = regex.exec(msg)) !== null) {\n          console.log(`Found ${arr[0]}. `, arr.index);\n          let fragment = document.createElement(\"span\");\n          fragment.className = classStr[matches[2]];\n          fragment.innerText = msg.slice(0, arr.index);\n          ele.appendChild(fragment);\n          let replaced = document.createElement(\"span\");\n          replaced.className=\"material-symbols-outlined supportMsg \"+classStr[matches[2]];\n          replaced.innerText = replacements[j].to;\n          console.log(replaced);\n          ele.appendChild(replaced);\n          msg = msg.slice(arr.index+replacements[j].from.length);\n        }\n        regex = new RegExp(\"(#[0-9a-zA-Z_\\\\-]){1,20}\", \"gmiu\");\n        while ((arr=regex.exec(msg))!== null) {\n          console.log(`Found ${arr[0]}. `, arr.index);\n          let fragment = document.createElement(\"span\");\n          fragment.className = classStr[matches[2]];\n          fragment.innerText = msg.slice(0, arr.index);\n          ele.appendChild(fragment);\n          let replaced = document.createElement(\"a\");\n          replaced.className=classStr[matches[2]];\n          replaced.innerText = arr[1];\n          ele.appendChild(replaced);\n          msg = msg.slice(arr.index+replacements[j].from.length);\n        }\n      }\n      newMsgBody.innerText = msg;\n      \n      ele.appendChild(newMsgBody);\n      ele.appendChild(document.createElement(\"br\"));\n    }\n    \n    if (!LOADEDQ2 || scrDistOKQ)\n    {\n      ele.scrollTop = ele.scrollHeight;\n      // console.log(\"Scrolling to bottom.\")\n      LOADEDQ2 = true;\n    }\n\n    \n  });\n  } catch (e) {\n    console.log(\"Restartng client (\"+e+\")\")\n    setTimeout(initClient, 0);\n  }\n} // initClient();\n\n\nconst replacements = [\n  {from:\":one:\", to:\"looks_one\"},\n  {from:\":two:\", to:\"looks_two\"},\n]"],
  "mappings": ";AAAA,SAAS,SAAS;AAKhB,WAAS,eAAe,QAAQ,EAAE,YAAY,eAC5C,SAAS,IAAI,MAAM,cAAc,EAAE;AACrC,aAAW,SAAS,IAAI,MAAM,cAAc,EAAE;AAChD;AAEA,SAAS,UAAU;AACjB,MAAI,MAAM,SAAS,eAAe,QAAQ;AAC1C,OAAK,KAAK,UAAU,EAAC,QAAO,WAAW,MAAK,EAAC,KAAI,IAAI,OAAO,MAAK,SAAQ,EAAC,CAAC,GAAG,MAAI;AAAA,EAAC,CAAC;AACpF,MAAI,QAAM;AACZ;AACA,IAAI,WAAW;AACf,MAAM,SAAS;AACf,MAAM,SAAS;AACf,MAAM,WAAW,CAAC,SAAS,QAAQ,SAAS,YAAY;AACxD,eAAe,aACf;AAEE,MAAI;AACJ,YAAQ,IAAI,kBAAkB;AAC9B,UAAM,SAAS,IAAI,YAAY,kBACA,SAAS,IAAI,MAAM,kCAAkC,EAAE,EAAE;AACxF,WAAO,iBAAiB,WAAW,aAAW;AAC5C,cAAQ,IAAI,OAAO,OAAO;AAC1B,YAAM,SAAS,eAAe,UAAU;AACxC,UAAI,QAAQ,QAAQ;AACpB,eAAS,eAAe,aAAa,EAAE,MAAM,UAAQ;AAErD,UAAI,UAAU,OAAO,KAAK,KAAK;AAC/B,UAAI,QAAQ,OAAO,KAAK,KAAK;AAC7B,aAAO,WAAW,OAAO;AACvB,YAAI,SAAS;AACX,cAAI,YAAW,IAAI,UAAU,QAAQ,QAAQ,KAAG,MAAM,EAAE;AAAA,QAC1D;AACA,YAAI,OAAO;AACT,cAAI,aAAY,MAAM,KAAG;AAAA,QAC3B;AACA,gBAAQ,MAAM,WAAW,QAAQ,EAAE;AACnC,gBAAQ,MAAM,WAAW,QAAQ,EAAE;AACnC,kBAAU,MAAM,MAAM,MAAM;AAC5B,gBAAQ,MAAM,MAAM,MAAM;AAAA,MAC5B;AACA,YAAM,SAAS,eAAe,SAAS;AACvC,UAAI,aAAe,IAAI,aAAe,IAAI,eAAa,IAAI,eAAe;AAC1E,UAAI,OAAO,MAAM,MAAM,GAAG;AAC1B,eAAS,IAAE,GAAG,IAAE,KAAK,QAAQ,KAAK;AAChC,YAAI,UAAU,KAAK,GAAG,MAAM,yBAAyB;AACrD,YAAI,CAAC;AAAS;AACd,YAAI,aAAa,SAAS,cAAc,GAAG;AAC3C,YAAI,eAAe,SAAS,cAAc,GAAG;AAE7C,qBAAa,YAAY,QAAQ;AACjC,qBAAa,YAAY,SAAS,QAAQ;AAC1C,YAAI,YAAY,YAAY;AAC5B,mBAAW,YAAY,SAAS,QAAQ;AACxC,YAAI,MAAM,QAAQ,GAAG,WAAW,QAAQ,GAAG;AAE3C,iBAAS,IAAE,GAAG,IAAE,aAAa,QAAQ,KAAK;AACxC,cAAI,QAAQ,IAAI,OAAO,aAAa,GAAG,MAAM,MAAM;AACnD,kBAAQ,MAAM,MAAM,KAAK,GAAG,OAAO,MAAM;AACvC,oBAAQ,IAAI,SAAS,IAAI,QAAQ,IAAI,KAAK;AAC1C,gBAAI,WAAW,SAAS,cAAc,MAAM;AAC5C,qBAAS,YAAY,SAAS,QAAQ;AACtC,qBAAS,YAAY,IAAI,MAAM,GAAG,IAAI,KAAK;AAC3C,gBAAI,YAAY,QAAQ;AACxB,gBAAI,WAAW,SAAS,cAAc,MAAM;AAC5C,qBAAS,YAAU,0CAAwC,SAAS,QAAQ;AAC5E,qBAAS,YAAY,aAAa,GAAG;AACrC,oBAAQ,IAAI,QAAQ;AACpB,gBAAI,YAAY,QAAQ;AACxB,kBAAM,IAAI,MAAM,IAAI,QAAM,aAAa,GAAG,KAAK,MAAM;AAAA,UACvD;AACA,kBAAQ,IAAI,OAAO,4BAA4B,MAAM;AACrD,kBAAQ,MAAI,MAAM,KAAK,GAAG,OAAM,MAAM;AACpC,oBAAQ,IAAI,SAAS,IAAI,QAAQ,IAAI,KAAK;AAC1C,gBAAI,WAAW,SAAS,cAAc,MAAM;AAC5C,qBAAS,YAAY,SAAS,QAAQ;AACtC,qBAAS,YAAY,IAAI,MAAM,GAAG,IAAI,KAAK;AAC3C,gBAAI,YAAY,QAAQ;AACxB,gBAAI,WAAW,SAAS,cAAc,GAAG;AACzC,qBAAS,YAAU,SAAS,QAAQ;AACpC,qBAAS,YAAY,IAAI;AACzB,gBAAI,YAAY,QAAQ;AACxB,kBAAM,IAAI,MAAM,IAAI,QAAM,aAAa,GAAG,KAAK,MAAM;AAAA,UACvD;AAAA,QACF;AACA,mBAAW,YAAY;AAEvB,YAAI,YAAY,UAAU;AAC1B,YAAI,YAAY,SAAS,cAAc,IAAI,CAAC;AAAA,MAC9C;AAEA,UAAI,CAAC,YAAY,YACjB;AACE,YAAI,YAAY,IAAI;AAEpB,mBAAW;AAAA,MACb;AAAA,IAGF,CAAC;AAAA,EACD,SAAS,GAAP;AACA,YAAQ,IAAI,uBAAqB,IAAE,GAAG;AACtC,eAAW,YAAY,CAAC;AAAA,EAC1B;AACF;AAGA,MAAM,eAAe;AAAA,EACnB,EAAC,MAAK,SAAS,IAAG,YAAW;AAAA,EAC7B,EAAC,MAAK,SAAS,IAAG,YAAW;AAC/B;",
  "names": []
}
