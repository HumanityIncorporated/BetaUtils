{
  "version": 3,
  "sources": ["../../frontend/utils.ts"],
  "sourcesContent": ["function globalOnload() {\n  document.onkeydown=keydown;\n}\n\nfunction send(params:any, callback:(thing:any)=>any) {\n  var xhr = new XMLHttpRequest();\n  xhr.open(\"POST\", \"server\", true);\n  xhr.setRequestHeader(\"Content-type\", \"application/json; charset=utf-8\");\n  xhr.onreadystatechange = ()=> {\n    if (xhr.readyState == 4 && xhr.status == 200) {\n      if (failureTimeout) clearTimeout(failureTimeout);\n      else closeAlert(true);\n      failureTimeout = null;\n      callback(JSON.parse(xhr.responseText));\n    }\n  }\n  xhr.send(params);\n  if (failureTimeout) clearTimeout(failureTimeout);\n  failureTimeout = setTimeout(()=>alertDialog(`This is taking longer than expected.`, ()=>{}, 1, params), 1000);\n}\n\nlet failureTimeout:NodeJS.Timeout|null;\nlet dialogQ = false;\nlet cbk: ()=>any = ()=>{};\nlet BLOCKCALLBACK = false;\nfunction alertDialog(str:string, callback:()=>any, button:number=-1, failedReq:string=\"\") {\n  let ele = document.getElementById(\"overlay\") as HTMLDivElement;\n  let p = document.getElementById(\"alerttext\") as HTMLParagraphElement;\n  if (!ele || !p) {\n    console.log(\"ERROR: Alert dialogs not enabled in this page.\")\n    return;\n  }\n  ele.style.top = \"0vh\";\n  dialogQ = true;\n  cbk = callback;\n  p.innerText = str;\n  if (button == 1) {\n    p.innerHTML += `<button class='btn szThird fssml' onclick='location.reload()'>Refresh?\n    <div class=\"anim\"></div></button>`\n    console.log(\"Failed request: \"+failedReq);\n    BLOCKCALLBACK=true;\n  }\n  else if (button == 2) {\n    p.innerHTML += `<br>\n    <p class=\"fssml gry nohover\"> [Press any key or click 'Continue' below to confirm] </p>\n    <button class='btn szFull red fssml cancel' onclick='closeAlert(true)'>\n    <span class=\"material-symbols-outlined\">cancel</span>Cancel\n    <div class=\"anim\"></div></button>`\n    console.log(\"Confirm speedbump\");\n  }\n  if (failureTimeout) clearTimeout(failureTimeout);\n  failureTimeout = null;\n}\n\nfunction closeAlert(overrideCallback:boolean=false) {\n  let ele = document.getElementById(\"overlay\") as HTMLDivElement;\n  ele.style.top = \"500vh\";\n  dialogQ = false;\n  if (cbk && !overrideCallback && !BLOCKCALLBACK) cbk();\n  \n}\n\nfunction keydown() {\n  if (dialogQ) {\n    console.log(\"CLOSED DIALOG\")\n    if (BLOCKCALLBACK) console.log(\"CALLBACK HAS BEEN BLOCKED\")\n    else closeAlert();\n    BLOCKCALLBACK = false;\n    \n  }\n}\n\nfunction toTime(ms:number) {\n  let day = Math.floor(ms/1000/60/60/24);\n  ms = ms%(1000*60*60*24);\n  let hr = Math.floor(ms/1000/60/60);\n  ms = ms%(1000*60*60);\n  let min = Math.floor(ms/1000/60);\n  ms = ms%(1000*60);\n  let sec = Math.floor(ms/1000);\n  if (ms<0) return \"00:00:00\";\n  return (day>0?day+\"d \":\"\") + padWithZero(hr)+\":\"+padWithZero(min)+\":\"+padWithZero(sec);\n}\n\nfunction padWithZero(n:number) {\n  return n<10?\"0\"+n:n;\n}"],
  "mappings": ";AAAA,SAAS,eAAe;AACtB,WAAS,YAAU;AACrB;AAEA,SAAS,KAAK,QAAY,UAA2B;AACnD,MAAI,MAAM,IAAI,eAAe;AAC7B,MAAI,KAAK,QAAQ,UAAU,IAAI;AAC/B,MAAI,iBAAiB,gBAAgB,iCAAiC;AACtE,MAAI,qBAAqB,MAAK;AAC5B,QAAI,IAAI,cAAc,KAAK,IAAI,UAAU,KAAK;AAC5C,UAAI;AAAgB,qBAAa,cAAc;AAAA;AAC1C,mBAAW,IAAI;AACpB,uBAAiB;AACjB,eAAS,KAAK,MAAM,IAAI,YAAY,CAAC;AAAA,IACvC;AAAA,EACF;AACA,MAAI,KAAK,MAAM;AACf,MAAI;AAAgB,iBAAa,cAAc;AAC/C,mBAAiB,WAAW,MAAI,YAAY,wCAAwC,MAAI;AAAA,EAAC,GAAG,GAAG,MAAM,GAAG,GAAI;AAC9G;AAEA,IAAI;AACJ,IAAI,UAAU;AACd,IAAI,MAAe,MAAI;AAAC;AACxB,IAAI,gBAAgB;AACpB,SAAS,YAAY,KAAY,UAAkB,SAAc,IAAI,YAAiB,IAAI;AACxF,MAAI,MAAM,SAAS,eAAe,SAAS;AAC3C,MAAI,IAAI,SAAS,eAAe,WAAW;AAC3C,MAAI,CAAC,OAAO,CAAC,GAAG;AACd,YAAQ,IAAI,gDAAgD;AAC5D;AAAA,EACF;AACA,MAAI,MAAM,MAAM;AAChB,YAAU;AACV,QAAM;AACN,IAAE,YAAY;AACd,MAAI,UAAU,GAAG;AACf,MAAE,aAAa;AAAA;AAEf,YAAQ,IAAI,qBAAmB,SAAS;AACxC,oBAAc;AAAA,EAChB,WACS,UAAU,GAAG;AACpB,MAAE,aAAa;AAAA;AAAA;AAAA;AAAA;AAKf,YAAQ,IAAI,mBAAmB;AAAA,EACjC;AACA,MAAI;AAAgB,iBAAa,cAAc;AAC/C,mBAAiB;AACnB;AAEA,SAAS,WAAW,mBAAyB,OAAO;AAClD,MAAI,MAAM,SAAS,eAAe,SAAS;AAC3C,MAAI,MAAM,MAAM;AAChB,YAAU;AACV,MAAI,OAAO,CAAC,oBAAoB,CAAC;AAAe,QAAI;AAEtD;AAEA,SAAS,UAAU;AACjB,MAAI,SAAS;AACX,YAAQ,IAAI,eAAe;AAC3B,QAAI;AAAe,cAAQ,IAAI,2BAA2B;AAAA;AACrD,iBAAW;AAChB,oBAAgB;AAAA,EAElB;AACF;AAEA,SAAS,OAAO,IAAW;AACzB,MAAI,MAAM,KAAK,MAAM,KAAG,MAAK,KAAG,KAAG,EAAE;AACrC,OAAK,MAAI,MAAK,KAAG,KAAG;AACpB,MAAI,KAAK,KAAK,MAAM,KAAG,MAAK,KAAG,EAAE;AACjC,OAAK,MAAI,MAAK,KAAG;AACjB,MAAI,MAAM,KAAK,MAAM,KAAG,MAAK,EAAE;AAC/B,OAAK,MAAI,MAAK;AACd,MAAI,MAAM,KAAK,MAAM,KAAG,GAAI;AAC5B,MAAI,KAAG;AAAG,WAAO;AACjB,UAAQ,MAAI,IAAE,MAAI,OAAK,MAAM,YAAY,EAAE,IAAE,MAAI,YAAY,GAAG,IAAE,MAAI,YAAY,GAAG;AACvF;AAEA,SAAS,YAAY,GAAU;AAC7B,SAAO,IAAE,KAAG,MAAI,IAAE;AACpB;",
  "names": []
}
