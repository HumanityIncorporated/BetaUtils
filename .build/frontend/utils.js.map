{
  "version": 3,
  "sources": ["../../frontend/utils.ts"],
  "sourcesContent": ["function globalOnload() {\n  document.onkeydown = keydown;\n  send(JSON.stringify({ action: \"userRequest\" }),\n    (res) => {\n      let maincontent = document.getElementsByClassName(\"main_content\").item(0) as HTMLDivElement;\n      let ftr = document.createElement(\"footer\");\n      maincontent.appendChild(ftr);\n      let ele = document.createElement(\"p\");\n      if (res.status != \"SUCCESS\")\n        ele.innerHTML = `<a href='/login'>Login</a> | \n                      <a href='/signup'>Sign-up</a> | \n                      <a href='/status'>Status</a> | \n                      BetaOS Systems | 2023`;\n      else {\n        ele.innerHTML = `Logged in as <kbd>${res.data.user}</kbd> |\n                      <a href='/logout'>Logout</a> | \n                      <a href='/config'>Account</a> | \n                      <a href='/status'>Status</a> | \n                      BetaOS Systems | 2023`;\n      }\n      ftr.appendChild(ele);\n    }\n  );\n\n\n  let ele2 = document.getElementById(\"overlay\");\n  if (ele2)\n    ele2.innerHTML = `\n  <div class=\"internal\">\n        <p class=\"fsmed\" id=\"alerttext\">Hey, some text here</p>\n        <button class=\"btn szHalf\" onclick=\"closeAlert()\" style=\"display: inline-block\">\n          <span class=\"alertlbl\">Continue</span>\n          <span class=\"material-symbols-outlined\">arrow_forward_ios</span>\n          <div class=\"anim\"></div>\n        </button>\n        <button class=\"btn szHalf red\" id=\"cancelBtn\" style=\"display: none\" onclick=\"closeAlert(true)\">\n          <span class=\"alertlbl\">Cancel</span>\n          <span class=\"material-symbols-outlined\">cancel</span>\n          <div class=\"anim\"></div>\n        </button>\n      </div>`;\n  else console.log(\"Alert dialogs disabled on this page\");\n  // update the alert-dialogs to allow cancel buttons\n  // cookie dialog also goes here\n}\n\nfunction send(params: any, callback: (thing: any) => any) {\n  var xhr = new XMLHttpRequest();\n  xhr.open(\"POST\", \"server\", true);\n  xhr.setRequestHeader(\"Content-type\", \"application/json; charset=utf-8\");\n  xhr.onreadystatechange = () => {\n    if (xhr.readyState == 4 && xhr.status == 200) {\n      if (failureTimeout) clearTimeout(failureTimeout);\n      else closeAlert(true);\n      failureTimeout = null;\n      callback(JSON.parse(xhr.responseText));\n    }\n  }\n  console.log(params);\n  xhr.send(params);\n  if (failureTimeout) clearTimeout(failureTimeout);\n  failureTimeout = setTimeout(() => alertDialog(`This is taking longer than expected.`, () => { }, 1, params), 1000);\n}\n\nlet failureTimeout: NodeJS.Timeout | null;\nlet dialogQ = false;\nlet cbk: () => any = () => { };\nlet BLOCKCALLBACK = false;\nfunction alertDialog(str: string, callback: () => any, button: number = -1, failedReq: string = \"\") {\n  let ele = document.getElementById(\"overlay\") as HTMLDivElement;\n  let p = document.getElementById(\"alerttext\") as HTMLParagraphElement;\n  if (!ele || !p) {\n    console.log(\"ERROR: Alert dialogs not enabled in this page.\")\n    return;\n  }\n  ele.style.top = \"0vh\";\n  dialogQ = true;\n  cbk = callback;\n  p.innerText = str;\n  document.getElementById(\"cancelBtn\").style.display = \"none\";\n  if (button == 1) {\n    p.innerHTML += `<button class='btn szThird fssml' onclick='location.reload()'>Refresh?\n    <div class=\"anim\"></div></button>`\n    console.log(\"Failed request: \" + failedReq);\n    BLOCKCALLBACK = true;\n  }\n  else if (button == 2) {\n    document.getElementById(\"cancelBtn\").style.display = \"inline-block\";\n    console.log(\"Confirm speedbump\");\n    BLOCKCALLBACK = true;\n  }\n  if (failureTimeout) clearTimeout(failureTimeout);\n  failureTimeout = null;\n}\n\nfunction closeAlert(overrideCallback: boolean = false) {\n  let ele = document.getElementById(\"overlay\") as HTMLDivElement;\n  ele.style.top = \"500vh\";\n  dialogQ = false;\n  if (cbk && !overrideCallback) {\n    console.log(\"calling back\")\n    cbk();\n  }\n  BLOCKCALLBACK = false;\n}\n\nfunction keydown(e: Event) {\n  if (dialogQ) {\n    e.preventDefault();\n    if (BLOCKCALLBACK) closeAlert(true);\n    else {\n      console.log(\"KEYDOWNCLOSEDIALOG\")\n      closeAlert();\n    }\n  }\n}\n\nfunction toTime(ms: number) {\n  let day = Math.floor(ms / 1000 / 60 / 60 / 24);\n  ms = ms % (1000 * 60 * 60 * 24);\n  let hr = Math.floor(ms / 1000 / 60 / 60);\n  ms = ms % (1000 * 60 * 60);\n  let min = Math.floor(ms / 1000 / 60);\n  ms = ms % (1000 * 60);\n  let sec = Math.floor(ms / 1000);\n  if (ms < 0) return \"00:00:00\";\n  return (day > 0 ? day + \"d \" : \"\") + padWithZero(hr) + \":\" + padWithZero(min) + \":\" + padWithZero(sec);\n}\n\nfunction padWithZero(n: number) {\n  return n < 10 ? \"0\" + n : n;\n}"],
  "mappings": "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",
  "names": []
}
