{
  "version": 3,
  "sources": ["../../frontend/betterSelect.js"],
  "sourcesContent": ["let version=\"v3\";\n\nfunction clickSelect(whichOne, openQ=0) \n{\n  // console.log(\"which one?\", whichOne);\n  let ctn = byId(whichOne);\n  // console.log(ctn);\n  // console.log(openQ);\n  if (openQ != 0) ctn.selectOpen = (openQ==1);\n  else ctn.selectOpen=!ctn.selectOpen;\n  // console.log(ctn.selectOpen);\n  \n  if (!ctn) {\n    console.error(\"No container found!\");\n    return;\n  }\n  // if open then close all others\n  // if (ctn.selectOpen)\n  // {\n    // if (currOpen) clickSelect(currOpen, -1);\n    // currOpen = whichOne;\n  // }\n  let inp = ctn.querySelector(\".betterSelect\");\n  inp.readOnly=!ctn.selectOpen;\n  inp.style.cursor = ctn.selectOpen?\"text\":\"pointer\";\n  ctn.querySelector(\".optionMenu\").className = \"optionMenu \"+ (ctn.selectOpen?\"open\":\"\");\n  // if (!ctn.selectOpen) {\n  {\n    inp.value = \"\";\n    // check if value is valid\n    let children = inp.nextElementSibling.children;\n    let valid = ctn.selectOpen; // valid if open\n    for (let i=0; i<children.length; i++) {\n      if (inp.selectedVal == children[i].innerText) { \n        valid = true;\n        inp.bSelValid = true;\n      }\n      if (ctn.selectOpen) children[i].tabIndex = 0;\n      else children[i].tabIndex=-1;\n    }\n    if (valid) {\n      // console.log(\"valid\");\n      inp.placeholder = inp.selectedVal?inp.selectedVal:\"Make a selection...\";\n      inp.classList.remove(\"invalid\");\n    }\n    else if (inp.selectedVal != undefined) {\n      inp.selectedVal = \"\";\n      inp.bSelValid = false;\n      inp.classList.add(\"invalid\");\n      inp.placeholder = \"Invalid selection\";\n    }\n  } // true\n}\n\nfunction enterEvent(inp, e) \n{\n  if (!e.target.classList.contains(\"betterSelect\"))\n    inp.value = e.target.innerText;\n  inp.selectedVal = inp.value;\n  // console.log('enter');\n  clickSelect(inp.parentElement.id);\n  inp.focus();\n  // console.log(inp.valueMap.get(inp.selectedVal));\n  if (inp.bSelOnChangeEvent && inp.bSelValid) inp.bSelOnChangeEvent(inp.selectedVal, inp.valueMap.get(inp.selectedVal));\n  e.preventDefault();\n}\nlet registered = [];\nfunction bSelRegister(id, onChange) \n{\n  let ctn = byId(id);\n  registered.push(id);\n  let inp = ctn.querySelector(\".betterSelect\");\n  inp.bSelOnChangeEvent = onChange;\n  console.log(onChange);\n  inp.valueMap = new Map();\n  let children = inp.nextElementSibling.children;\n  for (let i=0; i<children.length; i++) {\n    inp.valueMap.set(children[i].innerText, children[i].getAttribute(\"val\"));\n  }\n  inp.placeholder = \"Make a selection...\";\n  inp.addEventListener(\"click\", (e)=>{\n    // console.log(e.target);\n    clickSelect(e.target.parentElement.id, 1);\n    e.preventDefault();\n  });\n  ctn.addEventListener(\"click\", (e)=>{\n    if (e.target.classList.contains(\"option\")) \n    {\n      let inp = e.target.parentElement.parentElement.querySelector(\"input\");\n      // e.target.focus()\n      enterEvent(inp, e);\n    }\n  })\n  inp.bSelValid = false;\n}\n\nfunction bSelInitialise() {\n  console.log(\"Initialising BetterSelects\");\n  // bSelRegister(\"selCtn\", (value)=>{console.log(value);});\n  // <!-- bSelRegister(\"selCtn2\"); -->\n  document.addEventListener(\"click\", (e)=>{\n    if (e.target.closest(\".bSel\")) return;\n    // console.log(\"clicked away\");\n    for (let i=0; i<registered.length; i++) \n      clickSelect(registered[i], -1);\n  })\n  document.addEventListener(\"keydown\", (e)=>\n  {\n    if (!e.target.classList.contains(\"betterSelect\") \n     && !e.target.classList.contains(\"option\")) return;\n    // console.log(e.key);\n    let inp;\n    if (!e.target.classList.contains(\"betterSelect\")) \n      inp = e.target.parentElement.parentElement.querySelector(\"input\");\n    else inp = e.target;\n    switch (e.key) \n    {\n      case \" \":\n        if (e.target.classList.contains(\"betterSelect\"))\n          break;\n      case \"Enter\":\n        enterEvent(inp, e);\n        return;\n      case 'Escape':\n        clickSelect(inp.parentElement.id, -1);\n        inp.value = \"\";\n        e.preventDefault();\n        break;\n      case 'ArrowDown':\n        clickSelect(inp.parentElement.id, 1);\n        if (e.target.classList.contains(\"option\")) \n          if (e.target.nextElementSibling)\n            e.target.nextElementSibling.focus();\n          else \n            e.target.parentElement.children[0].focus();\n        else \n          e.target.nextElementSibling.children[0].focus();\n        break;\n      case 'ArrowUp':\n        clickSelect(inp.parentElement.id, 1);\n        if (e.target.classList.contains(\"option\")) \n          if (e.target.previousElementSibling)\n            e.target.previousElementSibling.focus();\n          else \n            e.target.parentElement.lastElementChild.focus();\n        else \n          // console.log(e.target.nextElementSibling);\n          e.target.nextElementSibling.lastElementChild.focus();\n      break;\n      default:\n        if (e.key.length == 1 && !e.target.classList.contains(\"betterSelect\")) // nothing stupid likee backspace/etc \n        {\n          let inp = e.target.parentElement.parentElement.querySelector(\"input\");\n          // inp.value = e.key;\n          inp.focus();\n          \n        }\n    } // switch (key)\n  })\n};"],
  "mappings": "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",
  "names": ["inp"]
}
