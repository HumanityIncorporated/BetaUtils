{
  "version": 3,
  "sources": ["../userRequest.ts"],
  "sourcesContent": ["const argon2 = require('argon2');\n// https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html\nimport {authDB, userRegex} from './consts';\n\nexport async function userRequest(token:string) {\n  let tokenData:{associatedUser:string, expiry:number} = await authDB.findOne({fieldName:\"Token\", token:token});\n  if (!tokenData) {\n    return {status:\"ERROR\", data:{error:\"Your session could not be found!\"}, token:\"\"}\n  }\n  let userData:{permLevel:number, alias:string} = await authDB.findOne({fieldName:\"UserData\", user:tokenData.associatedUser});\n  if (Date.now() > tokenData.expiry) {\n    return {status:\"ERROR\", data:{error:\"Your session has expired!\"}, token:\"\"};\n  }\n  return {status:\"SUCCESS\", data: {user: tokenData.associatedUser, alias:userData.alias??userData.user, perms:userData.permLevel, expiry: tokenData.expiry, tasks:userData.tasks}, token:token};\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,oBAAgC;AAFhC,MAAM,SAAS,QAAQ,QAAQ;AAI/B,eAAsB,YAAY,OAAc;AAC9C,MAAI,YAAmD,MAAM,qBAAO,QAAQ,EAAC,WAAU,SAAS,MAAW,CAAC;AAC5G,MAAI,CAAC,WAAW;AACd,WAAO,EAAC,QAAO,SAAS,MAAK,EAAC,OAAM,mCAAkC,GAAG,OAAM,GAAE;AAAA,EACnF;AACA,MAAI,WAA4C,MAAM,qBAAO,QAAQ,EAAC,WAAU,YAAY,MAAK,UAAU,eAAc,CAAC;AAC1H,MAAI,KAAK,IAAI,IAAI,UAAU,QAAQ;AACjC,WAAO,EAAC,QAAO,SAAS,MAAK,EAAC,OAAM,4BAA2B,GAAG,OAAM,GAAE;AAAA,EAC5E;AACA,SAAO,EAAC,QAAO,WAAW,MAAM,EAAC,MAAM,UAAU,gBAAgB,OAAM,SAAS,SAAO,SAAS,MAAM,OAAM,SAAS,WAAW,QAAQ,UAAU,QAAQ,OAAM,SAAS,MAAK,GAAG,MAAW;AAC9L;",
  "names": []
}
