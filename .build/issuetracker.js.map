{
  "version": 3,
  "sources": ["../issuetracker.ts"],
  "sourcesContent": ["import {issueDB} from './consts'\nimport {userRequest} from './userRequest'\nexport async function newIssue(title:string, body:string, prio:number, tags:string[], token:string, sessID:string, existingID:number=-1) \n{\n  if (title.length == 0 || body.length == 0) return {status:\"ERROR\", data:{error:\"Please provide a title and a description.\"}, token:token}\n  let data = await issueDB.findOne({fieldName:\"MetaData\"});\n  let req = await userRequest(token);\n  let auth = \"Anonymous user \"+sessID.slice(0,7);\n  if (prio <=0) return {status:\"ERROR\", data:{error:\"Invalid priority number!\"}, token:token};\n  if (req.status == \"SUCCESS\") {\n    auth = req.data.user as string;\n    if (req.data.perms < 2 && prio > 2) return {status:\"ERROR\", data:{error:\"Invalid priority number!\"}, token:token};\n  }\n  else if (prio > 2) return {status:\"ERROR\", data:{error:\"Invalid priority number!\"}, token:token}\n  await issueDB.insertOne({fieldName:\"Issue\", id:existingID>0?existingID:(data?data.issueCt+1:1), tags:tags, prio:prio, title:title, body:body, author:auth});  \n  if (data) \n    await issueDB.updateOne({fieldName:\"MetaData\"}, {\n      $inc: {issueCt: 1}\n    });\n  else await issueDB.insertOne({fieldName:\"MetaData\", issueCt:1});\n  return {status:\"SUCCESS\", data:{id:data.issueCt+1}, token:token};\n}\n\nexport async function loadIssues(from:number, ct:number, token:string) \n{\n  let out = await issueDB.find({fieldName:\"Issue\", id:{$gte:from}}).sort({id:1}).limit(ct).toArray();\n  let minIssue = await issueDB.find({fieldName:\"Issue\"}).sort({id: 1}).limit(1).toArray();\n  return {status:\"SUCCESS\", data:{issues:out, minID:(minIssue.length>0?minIssue[0].id:9999)}, token:token};\n}\n\nexport async function deleteIssue(id:number, token:string) \n{\n  let req = await userRequest(token);\n  if (req.status != \"SUCCESS\") return req;\n  await issueDB.deleteOne({fieldName:\"Issue\", id:Number(id)});\n  return {status:\"SUCCESS\", data:null, token:token};\n}\n\nexport async function completeIssue(id:number, token:string) \n{\n  let req = await userRequest(token);\n  if (req.status != \"SUCCESS\") return req;\n  await issueDB.updateOne({fieldName:\"Issue\", id:Number(id)}, {$set:{fieldName:\"CompletedIssue\"}});\n  return {status:\"SUCCESS\", data:null, token:token};\n}\n\nexport async function editIssue(id:number, title:string, body:string, prio:number, tags:string[], token:string) {\n  let res = await deleteIssue(id, token);\n  if (res.status != \"SUCCESS\") return res;\n  res = await newIssue(title, body, prio, tags, token, \"ERROR\", id);\n  return res;\n}"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAsB;AACtB,yBAA0B;AAC1B,eAAsB,SAAS,OAAc,MAAa,MAAa,MAAe,OAAc,QAAe,aAAkB,IACrI;AACE,MAAI,MAAM,UAAU,KAAK,KAAK,UAAU;AAAG,WAAO,EAAC,QAAO,SAAS,MAAK,EAAC,OAAM,4CAA2C,GAAG,MAAW;AACxI,MAAI,OAAO,MAAM,sBAAQ,QAAQ,EAAC,WAAU,WAAU,CAAC;AACvD,MAAI,MAAM,UAAM,gCAAY,KAAK;AACjC,MAAI,OAAO,oBAAkB,OAAO,MAAM,GAAE,CAAC;AAC7C,MAAI,QAAO;AAAG,WAAO,EAAC,QAAO,SAAS,MAAK,EAAC,OAAM,2BAA0B,GAAG,MAAW;AAC1F,MAAI,IAAI,UAAU,WAAW;AAC3B,WAAO,IAAI,KAAK;AAChB,QAAI,IAAI,KAAK,QAAQ,KAAK,OAAO;AAAG,aAAO,EAAC,QAAO,SAAS,MAAK,EAAC,OAAM,2BAA0B,GAAG,MAAW;AAAA,EAClH,WACS,OAAO;AAAG,WAAO,EAAC,QAAO,SAAS,MAAK,EAAC,OAAM,2BAA0B,GAAG,MAAW;AAC/F,QAAM,sBAAQ,UAAU,EAAC,WAAU,SAAS,IAAG,aAAW,IAAE,aAAY,OAAK,KAAK,UAAQ,IAAE,GAAI,MAAW,MAAW,OAAa,MAAW,QAAO,KAAI,CAAC;AAC1J,MAAI;AACF,UAAM,sBAAQ,UAAU,EAAC,WAAU,WAAU,GAAG;AAAA,MAC9C,MAAM,EAAC,SAAS,EAAC;AAAA,IACnB,CAAC;AAAA;AACE,UAAM,sBAAQ,UAAU,EAAC,WAAU,YAAY,SAAQ,EAAC,CAAC;AAC9D,SAAO,EAAC,QAAO,WAAW,MAAK,EAAC,IAAG,KAAK,UAAQ,EAAC,GAAG,MAAW;AACjE;AAEA,eAAsB,WAAW,MAAa,IAAW,OACzD;AACE,MAAI,MAAM,MAAM,sBAAQ,KAAK,EAAC,WAAU,SAAS,IAAG,EAAC,MAAK,KAAI,EAAC,CAAC,EAAE,KAAK,EAAC,IAAG,EAAC,CAAC,EAAE,MAAM,EAAE,EAAE,QAAQ;AACjG,MAAI,WAAW,MAAM,sBAAQ,KAAK,EAAC,WAAU,QAAO,CAAC,EAAE,KAAK,EAAC,IAAI,EAAC,CAAC,EAAE,MAAM,CAAC,EAAE,QAAQ;AACtF,SAAO,EAAC,QAAO,WAAW,MAAK,EAAC,QAAO,KAAK,OAAO,SAAS,SAAO,IAAE,SAAS,GAAG,KAAG,KAAK,GAAG,MAAW;AACzG;AAEA,eAAsB,YAAY,IAAW,OAC7C;AACE,MAAI,MAAM,UAAM,gCAAY,KAAK;AACjC,MAAI,IAAI,UAAU;AAAW,WAAO;AACpC,QAAM,sBAAQ,UAAU,EAAC,WAAU,SAAS,IAAG,OAAO,EAAE,EAAC,CAAC;AAC1D,SAAO,EAAC,QAAO,WAAW,MAAK,MAAM,MAAW;AAClD;AAEA,eAAsB,cAAc,IAAW,OAC/C;AACE,MAAI,MAAM,UAAM,gCAAY,KAAK;AACjC,MAAI,IAAI,UAAU;AAAW,WAAO;AACpC,QAAM,sBAAQ,UAAU,EAAC,WAAU,SAAS,IAAG,OAAO,EAAE,EAAC,GAAG,EAAC,MAAK,EAAC,WAAU,iBAAgB,EAAC,CAAC;AAC/F,SAAO,EAAC,QAAO,WAAW,MAAK,MAAM,MAAW;AAClD;AAEA,eAAsB,UAAU,IAAW,OAAc,MAAa,MAAa,MAAe,OAAc;AAC9G,MAAI,MAAM,MAAM,YAAY,IAAI,KAAK;AACrC,MAAI,IAAI,UAAU;AAAW,WAAO;AACpC,QAAM,MAAM,SAAS,OAAO,MAAM,MAAM,MAAM,OAAO,SAAS,EAAE;AAChE,SAAO;AACT;",
  "names": []
}
