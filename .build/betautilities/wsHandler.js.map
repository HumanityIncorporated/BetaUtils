{
  "version": 3,
  "sources": ["../../betautilities/wsHandler.ts"],
  "sourcesContent": ["// Copyright (c) 2023 BetaOS\nimport {WebSocket} from 'ws';\nimport {uDB} from '../consts';\nimport {replyMessage} from './messageHandle';\nimport { updateActive } from '../supportRooms';\n// import {systemLog} from './misc';\nimport {systemLog} from '../logging'\nconst fs = require('fs')\nimport {processHeimMessage, maybeGold, scramble} from '../decodegold';\n\n\nexport class WS \n{\n  static notifRoom:WS;\n  DATALOGGING = false;\n  static CALLTIMEOUT = 30000;\n  url:string;\n  static sockets:WS[] = [];\n  nick:string;\n  setNickQ: boolean = false;\n  socket: WebSocket;\n  pausedQ=false;\n  roomName:string;\n  static FAILSAFETIMEOUT:NodeJS.Timeout|null = null;\n  pauser:string|null = null;\n  failedQ = false;\n  callTimes:number[]=[];\n  callReset:NodeJS.Timeout|null = null;\n  callStatus=-1;\n  transferOutQ = false; // is a room that one should recommend transferring out?\n  bypass = false;\n  confirmcode = -1;\n  // static db = new Database();\n  static toSendInfo(msg: string, data:any=null) {\n    if (data) return JSON.stringify({\n      type:\"send\",\n      data:{content:msg, parent:data[\"data\"][\"id\"]}});\n    else \n      return JSON.stringify({type:\"send\", data:{content:msg}});\n  }\n\n  incrRunCt() {\n    uDB.findOne({fieldName: \"COUNTERS\"}).then(\n    (obj: {runCt:number})=>{\n      uDB.updateOne({fieldName:\"COUNTERS\"}, \n        {\n          $set: {'runCt': obj.runCt+1},\n          $currentDate: { lastModified: true }\n        })\n    });\n  }\n  incrPingCt() {\n    uDB.findOne({fieldName: \"COUNTERS\"}).then(\n    (obj: {pingCt:number})=>{\n      uDB.updateOne({fieldName:\"COUNTERS\"}, \n        {\n          $set: {'pingCt': obj.pingCt+1},\n          $currentDate: { lastModified: true }\n        })\n    });\n  }\n\n  displayStats(data:any) {\n    uDB.findOne({fieldName: \"COUNTERS\"}).then(\n      (obj: {runCt:number, pingCt: number}) => {\n        this.delaySendMsg(\"Run count: \"+obj.runCt+\"\\\\nPing count: \"+obj.pingCt, data, 0);\n    });\n  }\n\n  bumpCallReset(data:any)\n  {\n    if (this.callReset) \n      clearTimeout(this.callReset);\n    this.callReset = setTimeout(() => {\n      this.resetCall(data); \n    }, WS.CALLTIMEOUT);\n  }\n\n  clearCallReset() {\n    if (this.callReset) clearTimeout(this.callReset);\n    this.callStatus=-1;\n  }\n\n  resetCall(this:WS, data:any) {\n    if (this.callStatus >= 0) {\n      this.sendMsg(\"[CALLEND] Disconnected from BetaOS Services\", data);\n    }\n    this.callStatus= -1;\n  }\n\n  replyMessage(msg:string, sender:string, data:any):string\n  {\n    return \"\"\n  };\n\n  delaySendMsg(msg:string, data:any, delay:number) {\n    if (msg.length == 0) return;\n    if (delay == 0) this.sendMsg(msg, data) // instant send\n    else {\n      setTimeout(()=>{\n      this.sendMsg(msg, data)}, delay);\n    }\n    this.incrRunCt();\n  }\n\n  sendMsg(msg:string, data:any) {\n    this.socket.send(WS.toSendInfo(msg, data))\n    this.incrRunCt();\n  }\n  \n  onOpen() {\n    systemLog((\"BetaUtilities open in \"+this.socket.url));\n    WS.FAILSAFETIMEOUT =setTimeout(()=>{WS.resetTime =1000;}, 10000);\n  }\n\n  initNick() {\n    if (!this.setNickQ) this.changeNick(this.nick)\n    this.setNickQ = true;\n  }\n\n  changeNick(nick:string) {\n    this.socket.send(`{\"type\": \"nick\", \"data\": {\"name\": \"${nick}\"},\"id\": \"1\"}`);\n  }\n\n  onMessage(dat:string) {\n    \n    let data = JSON.parse(dat);\n    if (data[\"type\"] == \"ping-event\") {\n      let reply = `{\"type\": \"ping-reply\",\"data\": {\"time\":${data[\"data\"][\"time\"]}},\"id\":\"0\"}`;\n      this.socket.send(reply);\n      setTimeout(this.initNick.bind(this), 3000);\n    }\n    if (data[\"type\"] == \"send-event\") {\n      // check whether the message contents match the pattern\n      let msg = data[\"data\"][\"content\"].toLowerCase().trim();\n      let rawMsg = data[\"data\"][\"content\"];\n      let snd = data[\"data\"][\"sender\"][\"name\"];\n      if (this.DATALOGGING) {\n        // console.log(\"LOG\");\n        fs.writeFileSync('./msgLog.txt', fs.readFileSync('./msgLog.txt').toString()+((`(${this.roomName})[${snd}] ${msg}\\n`)));\n      }\n      // Required methods\n      // !kill\n      if (msg == \"!kill @\" + this.nick.toLowerCase()\n      || msg == \"!kill @cuebot\") {\n        this.sendMsg(\"/me crashes\", data);\n        setTimeout(()=>{\n          this.socket.close(1000, \"!killed by user.\");\n        }, 100);\n      }\n        \n      // !restore\n      else if (this.pausedQ && msg == \"!restore @\" + this.nick.toLowerCase()) {\n        this.sendMsg(\"/me has been unpaused\", data);   \n        updateActive(this.roomName, true);\n        this.pauser = null;\n        this.callTimes = [];\n        this.pausedQ = false;\n      } \n        \n      // !pause\n      else if (msg == \"!pause @\" + this.nick.toLowerCase()) {\n        this.sendMsg(\"/me has been paused\", data)\n        updateActive(this.roomName, false);\n        let reply = \"Enter !kill @\"+this.nick+\" to kill this bot, \"+\n          \"or enter !restore @\"+this.nick+\" to restore it.\";\n        this.sendMsg(reply, data);\n        this.pauser = snd;\n        this.pausedQ = true;\n      } \n      // check paused and pings\n      else if (this.pausedQ &&\n        (msg.match(\"!ping @\" + this.nick.toLowerCase(), \"gmiu\") ||\n         msg.match(\"!help @\" + this.nick.toLowerCase(), \"gmiu\"))) \n      {\n        this.sendMsg(\"/me has been paused by @\"+this.pauser, data);\n        return;\n      } \n      // general unpaused ping\n      else if (msg == \"!ping\") {\n        this.sendMsg(\"Pong!\", data)\n        this.incrPingCt();\n      } \n\n      // self-specific unpaused ping\n      else if (msg.match(\"!ping @\" + this.nick.toLowerCase() + \"$\")) {\n        this.sendMsg(\":white_check_mark: BetaOS services ONLINE\", data)\n        this.incrPingCt();\n      }\n        \n      // general unpaused help\n      else if (msg == \"!help\"){\n        this.sendMsg(\"Enter !help @\"+this.nick+\" for help!\", data);\n      } \n\n      // ws-exclusive commands\n      else if (msg == \"!decodegold\") \n      {\n        // get parentMessage\n        console.log(\"thing\");\n        let parentID = data[\"data\"][\"parent\"];\n        this.socket.send(JSON.stringify({\n          id:\"decodeGold\",\n          data:{id:parentID},\n          type:\"get-message\",\n        }));\n      }\n      else if (maybeGold(rawMsg)) \n      {\n        let content = data[\"data\"][\"content\"];\n        let sender = data[\"data\"][\"sender\"][\"name\"];\n        processHeimMessage(content, (msg:string)=>{\n          scramble(this.replyMessage(msg, snd, data), (result:string)=>{\n            // console.log(\"scrambled\",result)\n            this.euphReply(result, data)\n          });\n        });\n        \n       \n      }\n      // send to messageHandle to process messages.\n      else if (!this.pausedQ) {\n        if (data[\"data\"][\"sender\"][\"id\"].match(\"bot:\")) {\n          // don't respond to the bots.\n          return;\n        }\n        this.euphReply(this.replyMessage(msg.toLowerCase().trim(), snd, data), data);\n        // scramble(msg, (result:string)=>{\n          // console.log(\"scrambled\",result)\n          // this.euphReply(this.replyMessage(result, snd, data))\n        // });\n      }\n    } // sendevent\n    else if (data[\"type\"] == \"get-message-reply\" && data[\"id\"] == \"decodeGold\") \n    {\n      let content = data[\"data\"][\"content\"];\n      let sender = data[\"data\"][\"sender\"][\"name\"];\n      processHeimMessage(content, (result:string)=>{\n        this.euphReply(result.toLowerCase().trim(), data);\n      });\n    }\n  }\n\n  euphReply(msg:string, data:any) \n  {\n    let outStr = msg;\n    if (this.failedQ && outStr != \"\") outStr = \"/me is rebooting.\"\n    if (outStr == \"\") return;\n    if (!this.bypass) {\n      this.callTimes.push(Date.now());\n      setTimeout(() => {this.callTimes.shift();}, 60*5*1000) // five minutes.\n    }\n    if (!this.bypass && this.callTimes.length >= 5) {\n      // if (i == 2)\n        if (this.callTimes.length < 10) {\n          outStr = this.transferOutQ?outStr+\"\\\\n[AntiSpam] Consider moving to &bots or &test for large-scale testing. Thank you for your understanding.\"\n            : outStr+\" [AntiSpam warning]\";\n        } else if (this.transferOutQ) {\n          outStr = outStr+\"\\\\n[ANTISPAM] Automatically paused @\"+this.nick;\n          this.pausedQ = true;\n          this.pauser = \"BetaOS_ANTISPAM\";\n          this.resetCall(data);\n        }\n        else {\n          outStr = outStr+\" (AntiSpam overriden)\"\n        }\n    }\n    console.log(\"out\", outStr)\n    this.sendMsg(outStr, data);\n  }\n\n  errorSocket() {\n    this.pausedQ = false;\n    this.pauser = null;\n    this.changeNick(this.nick + \"[Error]\")\n    this.incrRunCt();\n    this.failedQ = true;\n    setTimeout(() => {\n      this.changeNick(this.nick)\n      this.incrRunCt();\n      updateActive(this.roomName, true);\n      this.failedQ = false;\n    }, 5000);\n    updateActive(this.roomName, false);\n  } // socketclose\n\n  static resetTime = 1000;\n  onClose(event:any) {\n    // console.log(\"socket closed\")\n    WS.sockets.splice(WS.sockets.indexOf(this), 1);\n    if (WS.FAILSAFETIMEOUT) {\n      clearTimeout(WS.FAILSAFETIMEOUT);\n      WS.FAILSAFETIMEOUT = null;\n    }\n    // systemLog((\"Perished in:\"+this.roomName);\n    if (event != 1000 && event!=1006) {\n      updateActive(this.roomName, false);\n      console.log(\"!killed in &\"+this.roomName);\n      setTimeout(() => {\n        new WS(this.url, this.nick, this.roomName, this.transferOutQ)\n        updateActive(this.roomName, true);\n      }, 1000);\n    } else {\n      updateActive(this.roomName, false);\n      if (event==1000) return;\n      WS.resetTime*=1.5;\n      if (WS.resetTime > 30000) {\n        WS.resetTime = 30000;\n        return;\n      }\n      setTimeout(()=>{\n        new WS(this.url, this.nick, this.roomName, this.transferOutQ)\n        updateActive(this.roomName, true);\n      }, WS.resetTime);\n      \n      console.log((\"Retrying in: \"+Math.round(WS.resetTime/1000)+\" seconds\"));\n      let dateStr = (new Date()).toLocaleDateString(\"en-US\", {timeZone:\"EST\"})+\"/\"+(new Date()).toLocaleTimeString(\"en-US\", {timeZone:\"EST\"});\n      console.log((\"[close] Connection at \"+this.url+\" was killed at \"+dateStr));\n    }\n  }\n\n  static killall() {\n    for(let i=0; i<WS.sockets.length; i++) {\n      WS.sockets[i].socket.close(1000, \"!killall-ed\");\n      updateActive(WS.sockets[i].roomName, false);\n    }\n  }\n  \n  constructor(url:string, nick:string, roomName:string, transferQ:boolean) {\n    this.nick = nick;\n    if (roomName == \"bots\") WS.notifRoom = this;\n    WS.sockets.push(this);\n    // console.log(WS.sockets);\n    this.url=url;\n    this.roomName = roomName;\n    this.socket = new WebSocket(url);\n    this.transferOutQ=transferQ;\n    this.socket.on('open', this.onOpen.bind(this));\n    this.socket.on('message', this.onMessage.bind(this));\n    this.socket.on('close', this.onClose.bind(this));\n    this.socket.on('error', (e)=>{\n      this.socket.close(1000, \"\");\n      // systemLog((\"ERROR for room-ID: \"+this.roomName)\n      updateActive(this.roomName, false);\n    })\n    this.replyMessage = (msg:string, sender:string, data:any) => {\n      return replyMessage(this, msg, sender, data);\n    }\n    \n  }\n}\n"],
  "mappings": "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",
  "names": ["msg"]
}
